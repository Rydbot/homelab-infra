{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":enableVulnerabilityAlerts",
    "docker:pinDigests",
    "helpers:pinGitHubActionDigests"
  ],
  "timezone": "Australia/Melbourne",
  "schedule": [
    "after 8pm",
    "before 6am"
  ],
  "labels": [
    "dependencies"
  ],
  "rebaseWhen": "conflicted",
  "prConcurrentLimit": 10,
  "branchConcurrentLimit": 10,
  "dependencyDashboardTitle": "Renovate Dependency Dashboard",
  "enabledManagers": [
    "flux",
    "kubernetes",
    "helm-values",
    "github-actions",
    "custom.regex"
  ],
  "ignorePaths": [
    "**/*.b64",
    "age-key.txt",
    "immich_backup_*.sql"
  ],
  "customManagers": [
    {
      "customType": "regex",
      "fileMatch": [
        "^ops/wow-images/mangoszero\\.ref$"
      ],
      "matchStrings": [
        "^(?<currentValue>v\\d+\\.\\d+\\.\\d+)\\s*$"
      ],
      "depNameTemplate": "mangoszero/server",
      "datasourceTemplate": "github-tags",
      "versioningTemplate": "semver"
    },
    {
      "customType": "regex",
      "fileMatch": [
        "^apps/wow/(realmd|mangosd)-deployment\\.yaml$",
        "^apps/wow/client-extract-cronjob\\.yaml$"
      ],
      "matchStrings": [
        "ghcr\\.io/rovxbot/mangoszero:server-(?<currentValue>v\\d+\\.\\d+\\.\\d+)"
      ],
      "depNameTemplate": "mangoszero/server",
      "datasourceTemplate": "github-tags",
      "versioningTemplate": "semver"
    }
  ],
  "packageRules": [
    {
      "description": "Auto-merge patch updates (safe defaults).",
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "description": "Group Flux Helm chart updates together.",
      "matchManagers": [
        "flux"
      ],
      "matchDatasources": [
        "helm"
      ],
      "groupName": "flux-helm-charts"
    },
    {
      "description": "Group Kubernetes image updates together.",
      "matchManagers": [
        "kubernetes"
      ],
      "matchDatasources": [
        "docker"
      ],
      "groupName": "kubernetes-images"
    },
    {
      "description": "Don't auto-merge major updates.",
      "matchUpdateTypes": [
        "major"
      ],
      "automerge": false
    }
  ]
}
