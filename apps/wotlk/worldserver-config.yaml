apiVersion: v1
kind: ConfigMap
metadata:
  name: wotlk-worldserver-config
data:
  worldserver.conf: |
    [worldserver]
    LogsDir = ""
    BindIP = "0.0.0.0"
    WorldServerPort = 8085
    RealmID = 1
    Console.Enable = 0
    BeepAtStart = 0
    DataDir = "${DATA_DIR}"

    SOAP.Enabled = 1
    SOAP.IP = "127.0.0.1"
    SOAP.Port = 7878
    SOAP.Username = "${SOAP_USERNAME}"
    SOAP.Password = "${SOAP_PASSWORD}"

    LoginDatabaseInfo     = "${DB_HOST};${DB_PORT};${DB_USER};${DB_PASSWORD};${DB_AUTH_DB}"
    WorldDatabaseInfo     = "${DB_HOST};${DB_PORT};${DB_USER};${DB_PASSWORD};${DB_WORLD_DB}"
    CharacterDatabaseInfo = "${DB_HOST};${DB_PORT};${DB_USER};${DB_PASSWORD};${DB_CHAR_DB}"

    # Database worker threads
    LoginDatabase.WorkerThreads = 1
    WorldDatabase.WorkerThreads = 1
    CharacterDatabase.WorkerThreads = 1
    WorldDatabase.SynchThreads = 1

    # Update settings
    Updates.CleanDeadRefMaxCount = 3

    # Rates for authentic server feel - normal progression
    Rate.XP.Kill = 1
    Rate.XP.Quest = 1
    Rate.XP.Explore = 1
    Rate.XP.Pet = 1
    Rate.Loot.Normal = 1
    Rate.Loot.Heroic = 1
    Rate.Loot.Raid = 1
    Rate.Money = 1
    Rate.Reputation = 1
    Rate.Honor = 1
    Rate.KillHonor = 1

    # Instance settings for active server feel
    Instance.ResetTimeHour = 24
    Instance.IgnoreLevel = 0
    Instance.IgnoreRaid = 0

    # World events and holidays
    Event.Announce = 1
    Holiday.IgnoreHolidayRequirements = 0

    # Battleground settings
    Battleground.QueueAnnouncer = 1
    Battleground.QueueAnnouncer.PlayerOnly = 0
    Battleground.RewardWinnerHonorFirst = 0
    Battleground.RewardWinnerHonorLast = 0
    Battleground.RewardWinnerArenaFirst = 0
    Battleground.RewardWinnerArenaLast = 0
    Battleground.RewardLoserHonorFirst = 0
    Battleground.RewardLoserHonorLast = 0

    # PvP settings
    PvPToken.Enable = 0
    PvPToken.MapAllowType = 4
    PvPToken.ItemID = 29434
    PvPToken.ItemCount = 1

    # Guild settings
    Guild.EventLogRecordsCount = 100
    Guild.BankEventLogRecordsCount = 25

    # Social features
    ChatFlood.MessageCount = 10
    ChatFlood.MessageDelay = 1
    ChatFlood.MuteTime = 10

    # Performance settings
    MapUpdate.Threads = 1
    UpdateUptimeInterval = 10
    MaxOverspeedPings = 2
    SaveRespawnTimeImmediately = 1
    MaxPrimaryTradeSkill = 2
    MinPrimaryTradeSkill = 1

    # Anti-cheat (basic)
    Warden.Enabled = 1
    Warden.NumMemChecks = 3
    Warden.NumOtherChecks = 7
    Warden.ClientResponseDelay = 30
    Warden.ClientCheckHoldOff = 30
    Warden.ClientCheckFailAction = 0

    # World scaling and population feel
    Visibility.GroupMode = 1
    Visibility.Distance.Continents = 90
    Visibility.Distance.Instances = 120
    Visibility.Distance.BG = 180

    # Creature settings
    CreatureFamilyAssistanceRadius = 10
    CreatureFamilyFleeAssistanceRadius = 30
    WorldBossLevelDiff = 3

    # Weather and environment
    ActivateWeather = 1

    # Corpse settings
    Corpse.Decay.NORMAL = 60
    Corpse.Decay.RARE = 300
    Corpse.Decay.ELITE = 300
    Corpse.Decay.RAREELITE = 300
    Corpse.Decay.WORLDBOSS = 3600

    # Mail settings
    MailDeliveryDelay = 60

    # Skill settings
    SkillChance.Prospecting = 0
    SkillChance.Milling = 0
    SkillChance.Disenchant = 50

    # Fishing settings
    FishingRequiresFish = 1

    # Calendar settings
    Calendar.Enable = 1

    # Stats limits (fixes disconnection issues)
    Stats.Limits.Enable = 0

    # Network settings
    Network.UseSocketActivation = 0
    Network.EnableProxyProtocol = 0
    Network.Threads = 1
    Network.TcpNodelay = 1
    Network.OutKBuff = -1
    Network.OutUBuff = 4096

    # Performance and stability settings
    MaxCoreStuckTime = 60
    MinWorldUpdateTime = 1

    # Remote access settings
    Ra.Enable = 0

    # MySQL settings
    MySQLExecutable = ""

    # Update settings
    Updates.Redundancy = 1
    Updates.AllowRehash = 1
    Updates.ArchivedRedundancy = 0

    # Spell queue settings
    SpellQueue.Enabled = 1
    SpellQueue.Window = 400

    # Event settings
    Sunsreach.CounterMax = 10000
    ScourgeInvasion.CounterFirst = 50
    ScourgeInvasion.CounterSecond = 100
    ScourgeInvasion.CounterThird = 150

    # Player settings
    PlayerStart.String = ""

    # Visibility settings
    Visibility.Distance.BGArenas = 250

    # NPC settings
    NpcRegenHPTimeIfTargetIsUnreachable = 10
    NpcRegenHPIfTargetIsUnreachable = 1

    # Debug settings
    Debug.Battleground = 0
    Debug.Arena = 0

    # Channel settings
    Channel.ModerationGMLevel = 1

    # Item settings
    Item.SetItemTradeable = 1

    # Logging settings
    AllowLoggingIPAddressesInDatabase = 1

    # LFG settings
    LFG.MaxKickCount = 2
    LFG.KickPreventionTimer = 900

    # World settings
    World.RealmAvailability = 1

    # Auction house settings
    AuctionHouse.WorkerThreads = 1

    # Logger settings
    Appender.Console=1,5,0,"1 9 3 6 5 8"
    Appender.Auth=2,5,0,Auth.log,w
    Logger.root = 4,Console Auth
