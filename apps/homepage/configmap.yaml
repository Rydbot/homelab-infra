apiVersion: v1
kind: ConfigMap
metadata:
  name: homepage-app-config
  namespace: homepage
data:
  settings.yaml: |
    ---
    title: cooked.beer
    theme: dark
    color: violet
    headerStyle: boxedWidgets
    hideVersion: true
    useEqualHeights: true
    statusStyle: "dot"

    background:
      image: https://homepage.cooked.beer/assets/998981.jpg
      opacity: 20
      blur: sm
      saturate: 150
      brightness: 90
    cardBlur: md

    quicklaunch:
      searchDescriptions: true
      hideInternetSearch: true
      showSearchSuggestions: true
      mobileButtonPosition: bottom-right

    layout:
      Media:
        style: row
        columns: 3
      Security:
        style: row
        columns: 3
      Cluster:
        style: row
        columns: 3

  services.yaml: |
    ---
    - Media:
        - Radarr:
            href: https://radarr.cooked.beer
            siteMonitor: http://radarr.media.svc.cluster.local:7878
            description: Movies automation
            icon: radarr
            target: _blank
            widget:
              type: kubernetes
              namespace: media
              app: radarr
              podSelector: app=radarr
        - Sonarr:
            href: https://sonarr.cooked.beer
            siteMonitor: http://sonarr.media.svc.cluster.local:8989/ping
            description: TV automation
            icon: sonarr
            target: _blank
            widget:
              type: kubernetes
              namespace: media
              app: sonarr
              podSelector: app=sonarr
        - Prowlarr:
            href: https://prowlarr.cooked.beer
            siteMonitor: http://prowlarr.media.svc.cluster.local:9696/ping
            description: Indexer management
            icon: prowlarr
            target: _blank
            widget:
              type: kubernetes
              namespace: media
              app: prowlarr
              podSelector: app=prowlarr
        - SABnzbd:
            href: https://sabnzbd.cooked.beer
            siteMonitor: http://sabnzbd.media.svc.cluster.local:8080
            description: Usenet downloads
            icon: sabnzbd
            target: _blank
            widget:
              type: kubernetes
              namespace: media
              app: sabnzbd
              podSelector: app=sabnzbd
        - Jellyseerr:
            href: https://jellyseerr.cooked.beer
            siteMonitor: http://jellyseerr.media.svc.cluster.local:5055/login
            description: Requests & discovery
            icon: jellyseerr
            target: _blank
            widget:
              type: kubernetes
              namespace: media
              app: jellyseerr
              podSelector: app=jellyseerr
        - Jellyfin (LAN):
            href: http://192.168.1.190:32096
            siteMonitor: http://jellyfin.media.svc.cluster.local:8096
            description: Local streaming
            icon: jellyfin
            target: _blank
            widget:
              type: kubernetes
              namespace: media
              app: jellyfin
              podSelector: app=jellyfin

    - Security:
        - Vaultwarden:
            href: https://vault.cooked.beer
            siteMonitor: http://vaultwarden.security.svc.cluster.local:80
            description: Password manager
            icon: bitwarden
            target: _blank
            widget:
              type: kubernetes
              namespace: security
              app: vaultwarden
              podSelector: app=vaultwarden

    - Cluster:
        - Longhorn (LAN):
            href: http://192.168.1.190:30080
            siteMonitor: http://longhorn-frontend.longhorn-system.svc.cluster.local:80
            description: Storage UI
            icon: longhorn
            target: _blank
            widget:
              type: kubernetes
              namespace: longhorn-system
              app: longhorn-ui
              podSelector: app=longhorn-ui
        - Pods by Node (LAN):
            href: http://192.168.1.190:32081
            siteMonitor: http://pod-report.homepage.svc.cluster.local:80
            description: Running pods per node
            icon: kubernetes
            target: _blank

    - Me:
        - GitHub:
            href: https://github.com/RovxBot
            description: My profile
            icon: github
            target: _blank
        - Blog:
            href: https://rovblog.cooked.beer
            description: rovblog.cooked.beer
            icon: mdi-rss
            target: _blank

  bookmarks.yaml: |
    ---
    []

  widgets.yaml: |
    ---
    - greeting:
        text_size: xl
        text: cooked.beer

    - search:
        provider: duckduckgo
        showSearchSuggestions: true
        target: _blank

    - datetime:
        text_size: xl
        format:
          dateStyle: medium
          timeStyle: short

    - kubernetes:
        cluster:
          show: false
        nodes:
          show: true
          cpu: true
          memory: true
          showLabel: true

  kubernetes.yaml: |
    ---
    mode: cluster

  custom.css: |
    :root {
      --anime-pink: 255 92 219;
      --anime-violet: 138 90 255;
      --anime-cyan: 80 220 255;
      --anime-glass: 20 24 38;
    }

    #page_container::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(900px 500px at 10% 0%, rgb(var(--anime-pink) / 0.20), transparent 55%),
        radial-gradient(900px 500px at 90% 0%, rgb(var(--anime-cyan) / 0.16), transparent 55%),
        radial-gradient(900px 700px at 50% 110%, rgb(var(--anime-violet) / 0.22), transparent 60%),
        linear-gradient(180deg, rgb(0 0 0 / 0.25), rgb(0 0 0 / 0.55));
      mix-blend-mode: screen;
      opacity: 0.75;
    }

    #page_container::after {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        repeating-linear-gradient(
          180deg,
          rgb(255 255 255 / 0.03) 0px,
          rgb(255 255 255 / 0.03) 1px,
          transparent 3px,
          transparent 6px
        );
      opacity: 0.35;
    }

    #information-widgets {
      border-bottom-color: rgb(var(--anime-violet) / 0.45) !important;
    }

    #information-widgets,
    dialog,
    .service-block {
      background: linear-gradient(180deg, rgb(var(--anime-glass) / 0.55), rgb(var(--anime-glass) / 0.30)) !important;
      backdrop-filter: blur(14px) saturate(1.25);
      box-shadow:
        0 8px 26px rgb(0 0 0 / 0.35),
        0 0 0 1px rgb(var(--anime-violet) / 0.22) inset;
      border-radius: 18px !important;
    }

    .information-widget-resource .resource-usage {
      height: 0.35rem !important;
      border-radius: 999px !important;
      overflow: hidden;
    }

    .information-widget-resource .resource-usage > div {
      background: linear-gradient(
        90deg,
        rgb(var(--anime-cyan) / 0.85),
        rgb(var(--anime-violet) / 0.85),
        rgb(var(--anime-pink) / 0.85)
      ) !important;
      box-shadow: 0 0 18px rgb(var(--anime-violet) / 0.35);
    }

    .widget-container span,
    .widget-container div {
      text-shadow: 0 0 18px rgb(var(--anime-violet) / 0.22);
    }

    #inner_wrapper .container a[href^="http"] {
      transition: transform 150ms ease, box-shadow 150ms ease, filter 150ms ease;
      filter: saturate(1.05);
    }

    #inner_wrapper .container a[href^="http"]:hover {
      transform: translateY(-2px);
      filter: saturate(1.2);
    }

    #inner_wrapper .container a[href^="http"] > div {
      box-shadow:
        0 10px 30px rgb(0 0 0 / 0.35),
        0 0 0 1px rgb(var(--anime-pink) / 0.18) inset;
      border-radius: 16px !important;
      backdrop-filter: blur(10px) saturate(1.15);
    }

    #inner_wrapper .container a[href^="http"]:hover > div {
      box-shadow:
        0 18px 50px rgb(0 0 0 / 0.45),
        0 0 0 1px rgb(var(--anime-pink) / 0.25) inset,
        0 0 28px rgb(var(--anime-violet) / 0.18);
    }

    /* Keep per-service widgets, but remove their layout footprint */
    #inner_wrapper .container a[href^="http"] > div {
      position: relative;
    }

    #inner_wrapper .container a[href^="http"] .service-container {
      position: absolute;
      top: 12px;
      right: 12px;
      width: auto !important;
      justify-content: flex-end;
      pointer-events: none;
      opacity: 0.95;
    }

    #inner_wrapper .container a[href^="http"] .service-block {
      min-width: 0 !important;
      padding: 0.25rem 0.45rem !important;
      margin: 0 0 0 0.4rem !important;
      border-radius: 999px !important;
      background: linear-gradient(
        180deg,
        rgb(var(--anime-glass) / 0.65),
        rgb(var(--anime-glass) / 0.35)
      ) !important;
      box-shadow:
        0 0 0 1px rgb(var(--anime-violet) / 0.22) inset,
        0 0 16px rgb(var(--anime-violet) / 0.12);
      backdrop-filter: blur(10px) saturate(1.2);
    }

    #inner_wrapper .container a[href^="http"] .service-block > div:first-child {
      font-size: 0.8rem !important;
      line-height: 1rem !important;
      font-weight: 700 !important;
      text-shadow: 0 0 16px rgb(var(--anime-violet) / 0.35);
    }

    #inner_wrapper .container a[href^="http"] .service-block > div:last-child {
      font-size: 0.55rem !important;
      line-height: 0.75rem !important;
      letter-spacing: 0.08em;
      opacity: 0.8;
    }

    /* Header layout: title + search on top, nodes under */
    #widgets-wrap {
      display: grid !important;
      grid-template-columns: auto 1fr auto;
      grid-template-areas:
        "greeting search datetime"
        "kubernetes kubernetes kubernetes";
      align-items: center;
      column-gap: 0.9rem;
      row-gap: 0.6rem;
    }

    /* Pull children of `#information-widgets-right` into the grid */
    #information-widgets-right {
      display: contents;
    }

    .information-widget-greeting {
      grid-area: greeting;
    }

    .information-widget-search {
      grid-area: search;
      width: 100%;
      max-width: 860px;
      justify-self: start;
    }

    .information-widget-search input {
      border-radius: 999px !important;
      background: rgb(var(--anime-glass) / 0.35) !important;
      box-shadow:
        0 0 0 1px rgb(var(--anime-violet) / 0.20) inset,
        0 0 22px rgb(var(--anime-violet) / 0.12);
    }

    .information-widget-datetime {
      grid-area: datetime;
      justify-self: end;
    }

    .information-widget-kubernetes {
      grid-area: kubernetes;
      width: 100%;
      margin: 0;
    }
